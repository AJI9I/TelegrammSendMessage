# План разработки проекта TeggammMessage

## Описание проекта
Программа для автоматической рассылки сообщений в выбранные чаты Telegram с возможностью авторизации под своим аккаунтом, выбора групп и автоматического вступления в группы из файла.

## Технические требования

### Функциональные требования

1. **Авторизация в Telegram**
   - Авторизация через Telegram API (Telethon или Pyrogram)
   - Сохранение сессии для повторного использования
   - Поддержка двухфакторной аутентификации (2FA)

2. **Управление группами**
   - Ручной выбор групп из списка диалогов
   - Загрузка файла с адресами групп (текстовый формат)
   - Парсинг адресов групп (username или invite links)
   - Отображение списка выбранных групп

3. **Автоматическое вступление в группы**
   - Проверка участия пользователя в группе
   - Автоматическое вступление, если пользователь не состоит
   - Обработка ошибок (группа недоступна, приватная, и т.д.)

4. **Рассылка сообщений**
   - Редактирование текста сообщения (многострочное поле)
   - Сохранение и загрузка шаблонов сообщений
   - Возможность прикрепления медиафайлов (опционально)
   - Рассылка в выбранные группы
   - Отображение прогресса рассылки

5. **Планировщик рассылок**
   - Режим немедленной рассылки (однократная отправка)
   - Режим интервальной рассылки (раз в N часов)
   - Режим расписания (конкретные времена, например: 9:00, 12:00, 14:00, 19:00)
   - Настройка часового пояса
   - Включение/выключение планировщика
   - Отображение следующей запланированной рассылки

6. **Защита от блокировки**
   - Настраиваемые задержки между действиями
   - Задержка между вступлениями в группы
   - Задержка между отправкой сообщений
   - Случайные вариации задержек (для естественности)

7. **Интерфейс пользователя**
   - Графический интерфейс (GUI) или консольный интерфейс
   - Отображение статуса операций
   - Логирование действий
   - Обработка ошибок с понятными сообщениями

### Нефункциональные требования

1. **Портативность**
   - Программа должна запускаться без установки
   - Возможность упаковки в один исполняемый файл (PyInstaller, cx_Freeze)
   - Или простой способ развертывания (requirements.txt, инструкции)

2. **Безопасность**
   - Безопасное хранение сессии Telegram
   - Не сохранение паролей в открытом виде
   - Обработка ошибок авторизации

3. **Производительность**
   - Асинхронная обработка операций
   - Оптимизация работы с большим количеством групп

4. **Удобство использования**
   - Понятный интерфейс
   - Инструкции по использованию
   - Обработка типичных ошибок

## Технологический стек

### Рекомендуемые технологии

1. **Язык программирования**: Python 3.8+
   - Кроссплатформенность
   - Богатая экосистема библиотек
   - Простота упаковки в исполняемый файл

2. **Telegram API библиотека**:
   - **Telethon** (рекомендуется) - асинхронная, стабильная
   - Или **Pyrogram** - более современная, но требует больше зависимостей

3. **Интерфейс пользователя**:
   - **tkinter** - встроен в Python, не требует установки
   - Или **PyQt5/PySide2** - более современный, но требует установки
   - Или **консольный интерфейс** с **rich** или **click**

4. **Упаковка**:
   - **PyInstaller** - для создания исполняемого файла
   - **auto-py-to-exe** - GUI для PyInstaller

5. **Дополнительные библиотеки**:
   - **asyncio** - для асинхронных операций
   - **aiofiles** - для асинхронной работы с файлами
   - **configparser** - для настроек
   - **logging** - для логирования
   - **schedule** или **APScheduler** - для планирования задач
   - **pytz** - для работы с часовыми поясами

## Структура проекта

```
TeggammMessage/
├── src/
│   ├── __init__.py
│   ├── main.py                 # Точка входа
│   ├── telegram_client.py      # Работа с Telegram API
│   ├── group_manager.py        # Управление группами
│   ├── message_sender.py       # Рассылка сообщений
│   ├── scheduler.py            # Планировщик рассылок
│   ├── ui/
│   │   ├── __init__.py
│   │   ├── main_window.py      # Главное окно
│   │   ├── auth_window.py      # Окно авторизации
│   │   └── settings_window.py  # Окно настроек
│   └── utils/
│       ├── __init__.py
│       ├── file_parser.py      # Парсинг файла с группами
│       ├── delay_manager.py    # Управление задержками
│       └── logger.py           # Логирование
├── config/
│   └── config.ini              # Конфигурационный файл
├── sessions/                   # Папка для сессий Telegram
├── logs/                       # Папка для логов
├── requirements.txt            # Зависимости
├── README.md                   # Документация
├── LICENSE                     # Лицензия
└── build.py                    # Скрипт для сборки
```

## Этапы разработки

### Этап 1: Базовая инфраструктура
- [ ] Настройка проекта и зависимостей
- [ ] Создание структуры папок
- [ ] Настройка логирования
- [ ] Создание конфигурационного файла

### Этап 2: Работа с Telegram API
- [ ] Реализация авторизации в Telegram
- [ ] Сохранение и загрузка сессии
- [ ] Получение списка диалогов
- [ ] Проверка участия в группе
- [ ] Вступление в группу

### Этап 3: Управление группами
- [ ] Парсинг файла с адресами групп
- [ ] Валидация адресов групп
- [ ] Ручной выбор групп из списка
- [ ] Управление списком выбранных групп

### Этап 4: Рассылка сообщений
- [ ] Отправка сообщения в группу
- [ ] Обработка ошибок при отправке
- [ ] Прогресс рассылки
- [ ] Логирование результатов

### Этап 5: Планировщик рассылок
- [ ] Реализация планировщика задач
- [ ] Режим интервальной рассылки (раз в N часов)
- [ ] Режим расписания (конкретные времена)
- [ ] Настройка часового пояса
- [ ] Управление активными задачами
- [ ] Отображение следующей запланированной рассылки

### Этап 6: Система задержек
- [ ] Реализация задержек между действиями
- [ ] Случайные вариации задержек
- [ ] Настройка задержек через интерфейс

### Этап 7: Пользовательский интерфейс
- [ ] Дизайн интерфейса
- [ ] Окно авторизации
- [ ] Главное окно с выбором групп
- [ ] Поле для редактирования сообщения (многострочное)
- [ ] Панель планировщика (режимы, настройки времени)
- [ ] Окно настроек
- [ ] Отображение прогресса и логов
- [ ] Отображение статуса планировщика

### Этап 8: Тестирование и оптимизация
- [ ] Тестирование всех функций
- [ ] Обработка edge cases
- [ ] Оптимизация производительности
- [ ] Исправление багов

### Этап 9: Упаковка и распространение
- [ ] Создание исполняемого файла
- [ ] Тестирование портативности
- [ ] Создание инструкций по использованию
- [ ] Подготовка финальной документации

## Конфигурация

### Параметры по умолчанию

```ini
[telegram]
api_id = YOUR_API_ID
api_hash = YOUR_API_HASH
session_file = sessions/session

[delays]
join_group_min = 5      # Минимальная задержка при вступлении (секунды)
join_group_max = 15     # Максимальная задержка при вступлении (секунды)
send_message_min = 3    # Минимальная задержка при отправке (секунды)
send_message_max = 10   # Максимальная задержка при отправке (секунды)

[scheduler]
enabled = false         # Включен ли планировщик
mode = immediate        # Режим: immediate, interval, schedule
interval_hours = 3      # Интервал в часах (для режима interval)
schedule_times = 9,12,14,19  # Времена рассылки через запятую (для режима schedule)
timezone = UTC          # Часовой пояс

[ui]
theme = default
language = ru
```

## Формат файла с группами

Текстовый файл, каждая строка - адрес группы:
- `@groupname` - username группы
- `https://t.me/groupname` - полная ссылка
- `t.me/groupname` - короткая ссылка
- `https://t.me/joinchat/xxxxx` - invite link

Пример:
```
@mygroup1
@mygroup2
https://t.me/anothergroup
t.me/yetanothergroup
```

## Планировщик рассылок

### Режимы работы

1. **Немедленная рассылка:**
   - Отправка сразу после нажатия кнопки
   - Однократная рассылка

2. **Интервальная рассылка:**
   - Пример: "раз в 3 часа"
   - Настройка: поле "Каждые N часов" (N - целое число)
   - Первая рассылка происходит сразу после включения
   - Следующие - через указанный интервал

3. **Рассылка по расписанию:**
   - Пример: "каждый день в 9, 12, 14, 19"
   - Настройка: поле "Времена (через запятую): 9,12,14,19"
   - Формат времени:
     - `9` или `09` → 09:00
     - `9:00` или `09:00` → 09:00
     - `12:30` → 12:30
     - Можно указывать с двоеточием или без: `9,12,14,19` или `9:00,12:00,14:00,19:00`
   - Рассылка происходит каждый день в указанные времена
   - Учитывается выбранный часовой пояс

### Примеры настройки

**Интервальная рассылка:**
- Режим: "Интервал"
- Поле: "Каждые 3 часа"
- Результат: рассылка каждые 3 часа

**Рассылка по расписанию:**
- Режим: "Расписание"
- Поле: "9,12,14,19" или "9:00,12:00,14:00,19:00"
- Часовой пояс: "Europe/Moscow"
- Результат: рассылка каждый день в 9:00, 12:00, 14:00 и 19:00 по московскому времени

## Риски и ограничения

1. **Ограничения Telegram API**
   - Лимиты на количество сообщений
   - Возможность блокировки аккаунта при спаме
   - Ограничения на вступление в группы

2. **Безопасность**
   - Необходимость хранения API credentials
   - Безопасность сессий

3. **Юридические аспекты**
   - Рассылка может нарушать правила Telegram
   - Необходимо предупреждение пользователя о рисках

## Предупреждения

⚠️ **ВАЖНО**: 
- Использование программы для спама может привести к блокировке аккаунта
- Необходимо соблюдать правила Telegram
- Рекомендуется использовать только для личных целей или с разрешения администраторов групп
- Программа предоставляется "как есть", без гарантий

